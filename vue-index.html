<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>15 Puzzle Generator</title>
		<meta name="viewport" content="user-scalable=yes, width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="css/vue-styles.css">
		<link href="https://fonts.googleapis.com/css?family=Mallanna" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Limelight" rel="stylesheet">
	</head>
  <body>
    <div id="app">
      <app-header></app-header>
			<main>

				<form>
					<div>
						<fieldset id="basics">
							<legend>Basic Puzzle</legend>
							<label>Color for the blank tile: <input v-model="basic.color" type="color" value="#0f8000"></label>


							<label>Image Width in pixels: <input v-model.number="basic.imageWidth" class="num" form="form" placeholder="Enter a number" min="0" type="number"/></label>

							<label>Image Height in pixels: <input v-model.number="basic.imageHeight" class="num" form="form" placeholder="Enter a number" min="0" type="number"/></label>


							<p id="puzz">Puzzle Dimensions:</p>

							<input-sel v-model.number="basic.widthTiles" label="Width in tiles:"></input-sel>
							<input-sel v-model.number="basic.heightTiles" label="Height in tiles:"></input-sel>



							<p>The canvas will have the same dimensions as the image you use.&nbsp;&nbsp;Edit your image as necessary such that each tile will be the same size with no remainder pixels.</p>
						</fieldset>
						<hr>
						<fieldset id="extras">
							<legend>Additional Features</legend>
							<label>Relative path to your image: <input placeholder="Optional" type="text"/></label>
							<label>Add helper image: <input v-model="additional.helperImage" type="checkbox" name="help" value="image"/></label>

						</fieldset>
					</div>

				</form>


				<div id="lang-select">
					<button @click="changeLangInd('down')"></button>
					<transition name="fade" mode="out-in">
						<span :key="currentLang">{{currentLang}}</span>
					</transition>
					<button @click="changeLangInd('up')"></button>
				</div>

				<div id="copy-email">
					<button	@click="doCopy"	id="copy"></button>
					<a href="mailto:?subject=Code%20for%20the%2015%20puzzle"><button id="email"></button></a>
				</div>


	      <div id="code">

					<template v-if="currentLang === 'HTML'">
	        	<code-html :image-width="basic.imageWidth" :image-height="basic.imageHeight"></code-html>

						<code-html-helper-image v-if="additional.helperImage"></code-html-helper-image>
					</template>


					<template v-if="currentLang === 'CSS'">
						<code-css :color="basic.color" :image-width="basic.imageWidth"></code-css>

						<code-css-helper-image :helper-image-width="helperImageWidth" v-if="additional.helperImage"></code-css-helper-image>

					</template>

	        <pre id="js"><code>const canvas = document.querySelector('canvas');
	          let ctx = canvas.getContext('2d');
	          let canvArray = [], pic = new Image();
	          for(let i = 0; i < </code><span class="info3">%</span><code>; i++){
	          &nbsp;&nbsp;for(let j = 0; j < </code><span class="info2">%</span><code>; j++){
	          &nbsp;&nbsp;&nbsp;&nbsp;canvArray.push([j * </code><span class="tileSize">%</span><code>, i * </code><span class="tileSize">%</span><code>]);
	          &nbsp;&nbsp;}
	          }

	          <span class="peach">function</span> getRands(amt){
	          &nbsp;&nbsp;let nums = new Set();
	          &nbsp;&nbsp;while(nums.size < amt){
	          &nbsp;&nbsp;&nbsp;&nbsp;let n = Math.floor(Math.random() * amt);
	          &nbsp;&nbsp;&nbsp;&nbsp;nums.add(n);
	          &nbsp;&nbsp;}
	          &nbsp;&nbsp;return [...nums];
	          }

	          <span class="peach">function</span> getInversions(arr){
	          &nbsp;&nbsp;let inversions = 0;
	          &nbsp;&nbsp;for(let i = 0; i < arr.length; i++){
	          &nbsp;&nbsp;&nbsp;&nbsp;if(arr[i] == null){continue;}
	          &nbsp;&nbsp;&nbsp;&nbsp;for(let j = 0; j < arr.length; j++){
	          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(arr[i] > arr[j + i]){
	          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inversions++;
	          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
	          &nbsp;&nbsp;&nbsp;&nbsp;}
	          &nbsp;&nbsp;}
	          &nbsp;&nbsp;return inversions;
	          }

	          <span class="peach">function</span> checkBoard(){
	          &nbsp;&nbsp;let randos = getRands(canvArray.length - 1);
	          &nbsp;&nbsp;let solArray = [];
	          &nbsp;&nbsp;randos.forEach((x,i) => {
	          &nbsp;&nbsp;&nbsp;&nbsp;solArray[x] = i;
	          &nbsp;&nbsp;});
	          &nbsp;&nbsp;return [solArray.concat([canvArray.length - 1]), randos.concat([canvArray.length - 1])];
	          }

	          let doable = checkBoard();
	          while(getInversions(doable[0]) % 2 !== 0){
	          &nbsp;&nbsp;doable = checkBoard();
	          }
	          let boardOrder = doable[0].slice();

	          pic.onload = () => {
	          &nbsp;&nbsp;for(let i = 0; i < canvArray.length - 1; i++){
	          &nbsp;&nbsp;&nbsp;&nbsp;ctx.drawImage(pic, canvArray[i][0], canvArray[i][1], </code><span class="tileSize">%</span><code>, </code><span class="tileSize">%</span><code>, canvArray[doable[1][i]][0], canvArray[doable[1][i]][1], </code><span class="tileSize">%</span><code>, </code><span class="tileSize">%</span><code>);
	          &nbsp;&nbsp;}
	          }

	          pic.src = '<span class="pathjs">[path to your image]</span>';

	          <span class="peach">function</span> swapTiles(x, y){
	          &nbsp;&nbsp;if(canvArray.length === 0){return;}
	          &nbsp;&nbsp;let tileClicked = (Math.floor(y / </code><span class="tileSize">%</span><code>) * </code><span class="info2">%</span><code>) + Math.floor(x / </code><span class="tileSize">%</span><code>);
	          &nbsp;&nbsp;let blank = boardOrder.indexOf(canvArray.length - 1);
	          &nbsp;&nbsp;let finalCheck;
	          &nbsp;&nbsp;let brdInd = boardOrder[tileClicked];
	          &nbsp;&nbsp;if(![1, </code><span class="info2">%</span><code>].includes(Math.abs(tileClicked - blank))){
	          &nbsp;&nbsp;&nbsp;&nbsp;return;
	          &nbsp;&nbsp;}
	          &nbsp;&nbsp;ctx.clearRect(canvArray[tileClicked][0], canvArray[tileClicked][1], </code><span class="tileSize">%</span><code>, </code><span class="tileSize">%</span><code>);
	          &nbsp;&nbsp;ctx.drawImage(pic, canvArray[brdInd][0], canvArray[brdInd][1], </code><span class="tileSize">%</span><code>, </code><span class="tileSize">%</span><code>, canvArray[blank][0], canvArray[blank][1], </code><span class="tileSize">%</span><code>, </code><span class="tileSize">%</span><code>);
	          &nbsp;&nbsp;[boardOrder[tileClicked], boardOrder[blank]] = [boardOrder[blank], boardOrder[tileClicked]];
	          &nbsp;&nbsp;if(boardOrder[0] === 0 && boardOrder[</code><span class="info2-1">%</span><code>] === </code><span class="info2-1">%</span><code> && boardOrder[</code><span class="info2xinfo3-1-1">%</span><code>] === </code><span class="info2xinfo3-1-1">%</span><code> && boardOrder[</code><span class="info2xinfo3-2">%</span><code>] === </code><span class="info2xinfo3-2">%</span><code>){
	          &nbsp;&nbsp;&nbsp;&nbsp;finalCheck = true;
	          &nbsp;&nbsp;&nbsp;&nbsp;for(let f = 0; f < boardOrder.length; f++){
	          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(boardOrder[f] !== f){
	          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finalCheck = false;
	          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
	          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
	          &nbsp;&nbsp;&nbsp;&nbsp;}
	          &nbsp;&nbsp;}
	          &nbsp;&nbsp;if(finalCheck){
	          &nbsp;&nbsp;&nbsp;&nbsp;ctx.drawImage(pic, </code><span class="info2-1xtileSize">%</span><code>, </code><span class="info3-1xtileSize">%</span><code>, </code><span class="tileSize">%</span><code>, </code><span class="tileSize">%</span><code>, </code><span class="info2-1xtileSize">%</span><code>, </code><span class="info3-1xtileSize">%</span><code>, </code><span class="tileSize">%</span><code>, </code><span class="tileSize">%</span><code>);
	          &nbsp;&nbsp;&nbsp;&nbsp;canvArray = [];
	          &nbsp;&nbsp;}
	          }

	          canvas.addEventListener('click', e => {
	          &nbsp;&nbsp;let x = e.offsetX;
	          &nbsp;&nbsp;let y = e.offsetY;
	          &nbsp;&nbsp;swapTiles(x,y);
	          });</code></pre>


	      </div>
		  </main>



    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
		<script src="vue-clipboard.min.js"></script>
    <script src="vue-app.js"></script>
  </body>
</html>
